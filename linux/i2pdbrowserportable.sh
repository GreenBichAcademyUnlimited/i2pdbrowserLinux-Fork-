#!/bin/bash
arch=$(uname -m)
language=$(echo $LANG | cut -c-5 | sed s/_/-/g)
version="45.6.0esr"
application="firefox"

echo "This script prepearing $application $version for use with I2Pd"

file="$application-$version.tar.bz2"
url="https://ftp.mozilla.org/pub/$application/releases/$version/linux-$arch/$language/$file"

dir="$application-portable"
mkdir "$dir"
cd "$dir"
echo "Downloading $application..."
wget -q $url
if [ $? -ne 0 ]; then # Not found error, trying to cut language variable
	language=$(echo $language | cut -c-2)
	# re-create variable with cutted lang
	url="https://ftp.mozilla.org/pub/$application/releases/$version/linux-$arch/$language/$file"
	wget -q $url
fi
if [ ! -f $file ]; then
	echo "Can't find downloaded file. Does FireFox support your system language?"
	exit 1;
fi
echo "Extracting archive, please wait..."
tar xfj $file
rm $file
mv $application app
fulldir=`pwd`
mkdir data
cat << EOF > data/prefs.js
# Mozilla User Preferences

/* Do not edit this file.
 *
 * If you make changes to this file while the application is running,
 * the changes will be overwritten when the application exits.
 *
 * To make a manual change to preferences, you can visit the URL about:config
 */

user_pref("accessibility.typeaheadfind.flashBar", 0);
user_pref("app.update.auto", false);
user_pref("app.update.enabled", false);
user_pref("app.update.lastUpdateTime.addon-background-update-timer", 0);
user_pref("app.update.lastUpdateTime.background-update-timer", 0);
user_pref("app.update.lastUpdateTime.blocklist-background-update-timer", 0);
user_pref("app.update.lastUpdateTime.browser-cleanup-thumbnails", 1484920875);
user_pref("app.update.lastUpdateTime.experiments-update-timer", 0);
user_pref("app.update.lastUpdateTime.search-engine-update-timer", 0);
user_pref("app.update.lastUpdateTime.xpi-signature-verification", 0);
user_pref("beacon.enabled", false);
user_pref("browser.cache.disk.capacity", 358400);
user_pref("browser.cache.disk.filesystem_reported", 1);
user_pref("browser.cache.disk.smart_size.enabled", false);
user_pref("browser.cache.disk.smart_size.first_run", false);
user_pref("browser.cache.disk.smart_size.use_old_max", false);
user_pref("browser.cache.frecency_experiment", 1);
user_pref("browser.download.importedFromSqlite", true);
user_pref("browser.download.panel.shown", true);
user_pref("browser.laterrun.bookkeeping.profileCreationTime", 1483665004);
user_pref("browser.laterrun.bookkeeping.sessionCount", 23);
user_pref("browser.laterrun.enabled", true);
user_pref("browser.migrated-sync-button", true);
user_pref("browser.migration.version", 40);
user_pref("browser.newtabpage.enhanced", true);
user_pref("browser.newtabpage.introShown", true);
user_pref("browser.newtabpage.storageVersion", 1);
user_pref("browser.pagethumbnails.storage_version", 3);
user_pref("browser.places.importBookmarksHTML", false);
user_pref("browser.places.smartBookmarksVersion", 7);
user_pref("browser.pocket.enabled", false);
user_pref("browser.preferences.advanced.selectedTabIndex", 4);
user_pref("browser.reader.detectedFirstArticle", true);
user_pref("browser.rights.3.shown", true);
user_pref("browser.safebrowsing.downloads.remote.enabled", false);
user_pref("browser.safebrowsing.enabled", false);
user_pref("browser.safebrowsing.malware.enabled", false);
user_pref("browser.safebrowsing.provider.mozilla.lastupdatetime", "1484920855787");
user_pref("browser.safebrowsing.provider.mozilla.nextupdatetime", "1484924455787");
user_pref("browser.search.countryCode", "EN");
user_pref("browser.search.region", "EN");
user_pref("browser.search.update", false);
user_pref("browser.sessionstore.upgradeBackup.latestBuildID", "20161209150850");
user_pref("browser.slowStartup.averageTime", 8415);
user_pref("browser.slowStartup.samples", 4);
user_pref("browser.startup.homepage_override.buildID", "20161209150850");
user_pref("browser.startup.homepage_override.mstone", "45.6.0");
user_pref("browser.syncPromoViewsLeftMap", "{\"passwords\":0}");
user_pref("browser.tabs.remote.autostart.2", true);
user_pref("browser.toolbarbuttons.introduced.pocket-button", true);
user_pref("browser.uiCustomization.state", "{\"placements\":{\"PanelUI-contents\":[\"edit-controls\",\"zoom-controls\",\"new-window-button\",\"privatebrowsing-button\",\"save-page-button\",\"print-button\",\"history-panelmenu\",\"fullscreen-button\",\"find-button\",\"preferences-button\",\"add-ons-button\",\"developer-button\",\"sync-button\"],\"addon-bar\":[\"addonbar-closebutton\",\"status-bar\"],\"PersonalToolbar\":[\"personal-bookmarks\"],\"nav-bar\":[\"urlbar-container\",\"search-container\",\"bookmarks-menu-button\",\"downloads-button\",\"home-button\",\"noscript-tbb\",\"toggle-button--jid1-ckhysaadh4nl6qjetpack-privacy-settings\",\"action-button--jid1-5fs7itlscuazbgwrjetpack-toggle\",\"useragentoverrider-button\"],\"TabsToolbar\":[\"tabbrowser-tabs\",\"new-tab-button\",\"alltabs-button\"],\"toolbar-menubar\":[\"menubar-items\"]},\"seen\":[\"pocket-button\",\"developer-button\",\"toggle-button--jid1-ckhysaadh4nl6qjetpack-privacy-settings\",\"action-button--jid1-5fs7itlscuazbgwrjetpack-toggle\"],\"dirtyAreaCache\":[\"PersonalToolbar\",\"nav-bar\",\"TabsToolbar\",\"toolbar-menubar\",\"PanelUI-contents\",\"addon-bar\"],\"currentVersion\":5,\"newElementCount\":0}");
user_pref("browser.urlbar.daysBeforeHidingSuggestionsPrompt", 0);
user_pref("browser.urlbar.lastSuggestionsPromptDate", 0);
user_pref("camera.control.face_detection.enabled", false);
user_pref("capability.policy.maonoscript.sites", "add0n.com addons.mozilla.org afx.ms ajax.aspnetcdn.com ajax.googleapis.com bootstrapcdn.com code.jquery.com firstdata.com firstdata.lv gfx.ms google.com googlevideo.com gstatic.com hotmail.com live.com live.net maps.googleapis.com mozilla.net netflix.com nflxext.com nflximg.com nflxvideo.net noscript.net outlook.com passport.com passport.net passportimages.com paypal.com paypalobjects.com persona.org securecode.com securesuite.net sfx.ms tinymce.cachefly.net wlxrs.com yahoo.com yahooapis.com yandex.st yimg.com youtube.com ytimg.com [System+Principal] about: about:addons about:blank about:blocked about:certerror about:config about:crashes about:feeds about:home about:memory about:neterror about:plugins about:pocket-saved about:pocket-signup about:preferences about:privatebrowsing about:sessionrestore about:srcdoc about:support blob: chrome: http://add0n.com http://afx.ms http://bootstrapcdn.com http://firstdata.com http://firstdata.lv http://gfx.ms http://google.com http://googlevideo.com http://gstatic.com http://hotmail.com http://live.com http://live.net http://mozilla.net http://netflix.com http://nflxext.com http://nflximg.com http://nflxvideo.net http://noscript.net http://outlook.com http://passport.com http://passport.net http://passportimages.com http://paypal.com http://paypalobjects.com http://persona.org http://securecode.com http://securesuite.net http://sfx.ms http://wlxrs.com http://yahoo.com http://yahooapis.com http://yandex.st http://yimg.com http://youtube.com http://ytimg.com https://add0n.com https://afx.ms https://bootstrapcdn.com https://firstdata.com https://firstdata.lv https://gfx.ms https://google.com https://googlevideo.com https://gstatic.com https://hotmail.com https://live.com https://live.net https://mozilla.net https://netflix.com https://nflxext.com https://nflximg.com https://nflxvideo.net https://noscript.net https://outlook.com https://passport.com https://passport.net https://passportimages.com https://paypal.com https://paypalobjects.com https://persona.org https://securecode.com https://securesuite.net https://sfx.ms https://wlxrs.com https://yahoo.com https://yahooapis.com https://yandex.st https://yimg.com https://youtube.com https://ytimg.com mediasource: moz-extension: moz-safe-about: resource:");
user_pref("datareporting.healthreport.nextDataSubmissionTime", "1483758796140");
user_pref("datareporting.healthreport.pendingDeleteRemoteData", true);
user_pref("datareporting.healthreport.service.enabled", false);
user_pref("datareporting.healthreport.uploadEnabled", false);
user_pref("datareporting.policy.dataSubmissionPolicyAcceptedVersion", 2);
user_pref("datareporting.policy.dataSubmissionPolicyNotifiedTime", "1483665064786");
user_pref("datareporting.policy.firstRunTime", "1483758743815");
user_pref("datareporting.sessions.current.activeTicks", 238);
user_pref("datareporting.sessions.current.clean", true);
user_pref("datareporting.sessions.current.firstPaint", 6767);
user_pref("datareporting.sessions.current.main", 5420);
user_pref("datareporting.sessions.current.sessionRestored", 10940);
user_pref("datareporting.sessions.current.startTime", "1483758735273");
user_pref("datareporting.sessions.current.totalTime", 1465);
user_pref("datareporting.sessions.currentIndex", 4);
user_pref("datareporting.sessions.previous.0", "{\"s\":1483665002804,\"a\":10,\"t\":1752,\"c\":true,\"m\":20,\"fp\":2420,\"sr\":2038}");
user_pref("datareporting.sessions.previous.1", "{\"s\":1483668755299,\"a\":1,\"t\":4,\"c\":true,\"m\":16,\"fp\":-1,\"sr\":-1}");
user_pref("datareporting.sessions.previous.2", "{\"s\":1483725902261,\"a\":1,\"t\":11,\"c\":true,\"m\":2106,\"fp\":-1,\"sr\":-1}");
user_pref("datareporting.sessions.previous.3", "{\"s\":1483758707950,\"a\":2,\"t\":15,\"c\":true,\"m\":1605,\"fp\":10144,\"sr\":8840}");
user_pref("device.sensors.enabled", false);
user_pref("dom.apps.reset-permissions", true);
user_pref("dom.battery.enabled", false);
user_pref("dom.enable_performance", false);
user_pref("dom.enable_resource_timing", false);
user_pref("dom.enable_user_timing", false);
user_pref("dom.event.clipboardevents.enabled", false);
user_pref("dom.indexedDB.enabled", false);
user_pref("dom.mozApps.used", true);
user_pref("dom.storage.enabled", false);
user_pref("e10s.rollout.cohort", "disqualified-test");
user_pref("e10s.rollout.cohortSample", "0.659490");
user_pref("experiments.activeExperiment", false);
user_pref("extensions.blocklist.pingCountTotal", 8);
user_pref("extensions.blocklist.pingCountVersion", -1);
user_pref("extensions.bootstrappedAddons", "{\"loop@mozilla.org\":{\"version\":\"1.1.14\",\"type\":\"extension\",\"descriptor\":\"$fulldir/app/browser/features/loop@mozilla.org.xpi\",\"multiprocessCompatible\":false,\"runInSafeMode\":true},\"jid1-5Fs7iTLscUaZBgwr@jetpack\":{\"version\":\"1.0.16\",\"type\":\"extension\",\"descriptor\":\"$fulldir/data/extensions/jid1-5Fs7iTLscUaZBgwr@jetpack.xpi\",\"multiprocessCompatible\":true,\"runInSafeMode\":false},\"useragentoverrider@qixinglu.com\":{\"version\":\"0.4.1\",\"type\":\"extension\",\"descriptor\":\"$fulldir/data/extensions/useragentoverrider@qixinglu.com.xpi\",\"multiprocessCompatible\":false,\"runInSafeMode\":false},\"NoTrash@Off.JustOff\":{\"version\":\"0.4.6\",\"type\":\"extension\",\"descriptor\":\"$fulldir/data/extensions/NoTrash@Off.JustOff.xpi\",\"multiprocessCompatible\":true,\"runInSafeMode\":false},\"jid1-CKHySAadH4nL6Q@jetpack\":{\"version\":\"0.2.4\",\"type\":\"extension\",\"descriptor\":\"$fulldir/data/extensions/jid1-CKHySAadH4nL6Q@jetpack.xpi\",\"multiprocessCompatible\":true,\"runInSafeMode\":false}}");
user_pref("extensions.databaseSchema", 17);
user_pref("extensions.e10s.rollout.blocklist", "{dc572301-7619-498c-a57d-39143191b318}");
user_pref("extensions.e10s.rollout.hasAddon", false);
user_pref("extensions.e10s.rollout.policy", "50allmpc");
user_pref("extensions.e10sBlockedByAddons", true);
user_pref("extensions.enabledAddons", "%7B73a6fe31-595d-460b-a920-fcc0f8843232%7D:2.9.5.3,%7B972ce4c6-7e08-4474-a285-3208198ce6fd%7D:45.6.0");
user_pref("extensions.getAddons.cache.lastUpdate", 1484920667);
user_pref("extensions.getAddons.databaseSchema", 5);
user_pref("extensions.hotfix.lastVersion", "20160826.01");
user_pref("extensions.jid1-5Fs7iTLscUaZBgwr@jetpack.sdk.baseURI", "resource://jid1-5fs7itlscuazbgwr-at-jetpack/");
user_pref("extensions.jid1-5Fs7iTLscUaZBgwr@jetpack.sdk.domain", "jid1-5fs7itlscuazbgwr-at-jetpack");
user_pref("extensions.jid1-5Fs7iTLscUaZBgwr@jetpack.sdk.load.reason", "startup");
user_pref("extensions.jid1-5Fs7iTLscUaZBgwr@jetpack.sdk.rootURI", "jar:file://$fulldir/data/extensions/jid1-5Fs7iTLscUaZBgwr@jetpack.xpi!/");
user_pref("extensions.jid1-5Fs7iTLscUaZBgwr@jetpack.sdk.version", "1.0.16");
user_pref("extensions.jid1-CKHySAadH4nL6Q@jetpack.sdk.baseURI", "resource://jid1-ckhysaadh4nl6q-at-jetpack/");
user_pref("extensions.jid1-CKHySAadH4nL6Q@jetpack.sdk.domain", "jid1-ckhysaadh4nl6q-at-jetpack");
user_pref("extensions.jid1-CKHySAadH4nL6Q@jetpack.sdk.load.reason", "startup");
user_pref("extensions.jid1-CKHySAadH4nL6Q@jetpack.sdk.rootURI", "jar:file://$fulldir/data/extensions/jid1-CKHySAadH4nL6Q@jetpack.xpi!/");
user_pref("extensions.jid1-CKHySAadH4nL6Q@jetpack.sdk.version", "0.2.4");
user_pref("extensions.jid1-CKHySAadH4nL6Q@jetpack.version", "0.2.4");
user_pref("extensions.lastAppVersion", "45.6.0");
user_pref("extensions.lastPlatformVersion", "45.6.0");
user_pref("extensions.pendingOperations", false);
user_pref("extensions.shownSelectionUI", true);
user_pref("extensions.systemAddonSet", "{\"schema\":1,\"addons\":{}}");
user_pref("extensions.ui.dictionary.hidden", true);
user_pref("extensions.ui.experiment.hidden", true);
user_pref("extensions.ui.lastCategory", "addons://list/plugin");
user_pref("extensions.ui.locale.hidden", true);
user_pref("extensions.useragentoverrider.activated", true);
user_pref("extensions.useragentoverrider.currentLabel", "Google Bot");
user_pref("extensions.useragentoverrider.entries", "Linux / Firefox 44: Mozilla/5.0 (X11; Fedora; Linux x86_64; rv:44.0) Gecko/20100101 Firefox/44.0\nMac OS X/ Safari: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_2) AppleWebKit/601.3.9 (KHTML, like Gecko) Version/9.0.2 Safari/601.3.9\nWindows / IE 11: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko\nWindows / Edge: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2486.0 Safari/537.36 Edge/13.10586\n\nAndroid / Chrome 40: Mozilla/5.0 (Linux; Android 5.1.1; Nexus 4 Build/LMY48T) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/40.0.2214.89 Mobile Safari/537.36\niOS / Safari 9: Mozilla/5.0 (iPhone; CPU iPhone OS 9_2_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13D15 Safari/601.1\n\nGoogle Bot: Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)\nPS4: Mozilla/5.0 (PlayStation 4 3.15) AppleWebKit/537.73 (KHTML, like Gecko)\nCurl: curl/7.43.0\n");
user_pref("extensions.useragentoverrider.firstRun", false);
user_pref("extensions.xpiState", "{\"app-profile\":{\"jid1-CKHySAadH4nL6Q@jetpack\":{\"d\":\"$fulldir/data/extensions/jid1-CKHySAadH4nL6Q@jetpack.xpi\",\"e\":true,\"v\":\"0.2.4\",\"st\":1484920211000},\"NoTrash@Off.JustOff\":{\"d\":\"$fulldir/data/extensions/NoTrash@Off.JustOff.xpi\",\"e\":true,\"v\":\"0.4.6\",\"st\":1484920211000},\"useragentoverrider@qixinglu.com\":{\"d\":\"$fulldir/data/extensions/useragentoverrider@qixinglu.com.xpi\",\"e\":true,\"v\":\"0.4.1\",\"st\":1484920211000},\"{73a6fe31-595d-460b-a920-fcc0f8843232}\":{\"d\":\"$fulldir/data/extensions/{73a6fe31-595d-460b-a920-fcc0f8843232}.xpi\",\"e\":true,\"v\":\"2.9.5.3\",\"st\":1484920211000},\"jid1-5Fs7iTLscUaZBgwr@jetpack\":{\"d\":\"$fulldir/data/extensions/jid1-5Fs7iTLscUaZBgwr@jetpack.xpi\",\"e\":true,\"v\":\"1.0.16\",\"st\":1484920211000}},\"app-system-defaults\":{\"loop@mozilla.org\":{\"d\":\"$fulldir/app/browser/features/loop@mozilla.org.xpi\",\"e\":true,\"v\":\"1.1.14\",\"st\":1481342274000}},\"app-global\":{\"{972ce4c6-7e08-4474-a285-3208198ce6fd}\":{\"d\":\"$fulldir/app/browser/extensions/{972ce4c6-7e08-4474-a285-3208198ce6fd}.xpi\",\"e\":true,\"v\":\"45.6.0\",\"st\":1481342274000}},\"app-system-share\":{\"ubufox@ubuntu.com\":{\"d\":\"/usr/share/mozilla/extensions/{ec8030f7-c20a-464f-9b0e-13a3a9e97384}/ubufox@ubuntu.com.xpi\",\"e\":false,\"v\":\"3.2\",\"st\":1442597402000}}}");
user_pref("gecko.buildID", "20161209150850");
user_pref("gecko.mstone", "45.6.0");
user_pref("geo.enabled", false);
user_pref("idle.lastDailyNotification", 1484830809);
user_pref("intl.accept_languages", "en-us,en");
user_pref("layout.css.visited_links_enabled", false);
user_pref("loop.enabled", false);
user_pref("media.gmp-eme-adobe.enabled", false);
user_pref("media.gmp-manager.buildID", "20161209150850");
user_pref("media.gmp-manager.lastCheck", 1484851826);
user_pref("media.gmp.storage.version.observed", 1);
user_pref("media.peerconnection.ice.default_address_only", true);
user_pref("network.cookie.prefsMigrated", true);
user_pref("network.http.sendSecureXSiteReferrer", false);
user_pref("network.predictor.cleaned-up", true);
user_pref("network.proxy.http", "127.0.0.1");
user_pref("network.proxy.http_port", 4444);
user_pref("network.proxy.socks", "127.0.0.1");
user_pref("network.proxy.socks_port", 4447);
user_pref("network.proxy.socks_remote_dns", true);
user_pref("network.proxy.type", 1);
user_pref("network.websocket.enabled", false);
user_pref("noscript.ABE.cspHeaderDelim", "ABE0-4775013546535096");
user_pref("noscript.ABE.migration", 1);
user_pref("noscript.gtemp", "");
user_pref("noscript.subscription.lastCheck", -1137919763);
user_pref("noscript.temp", "");
user_pref("noscript.version", "2.9.5.3");
user_pref("noscript.visibleUIChecked", true);
user_pref("pdfjs.migrationVersion", 2);
user_pref("places.database.lastMaintenance", 1484292662);
user_pref("places.history.expiration.transient_current_max_pages", 104858);
user_pref("plugin.disable_full_page_plugin_for_types", "application/pdf,audio/flac,audio/mpeg,audio/x-mpegurl,audio/ogg,audio/x-wav,audio/x-ms-wma,video/x-ms-asf,video/x-msvideo,video/x-flv,video/x-matroska,video/mpeg,video/mp4,video/ogg,video/quicktime,video/webm,video/x-ms-wmv,audio/amr,video/3gpp,application/ogg,video/x-ms-wvx,application/xspf+xml,audio/x-realaudio,application/futuresplash,application/x-shockwave-flash,audio/ogg;codecs=opus");
user_pref("plugin.importedState", true);
user_pref("plugin.state.flash", 0);
user_pref("plugin.state.java", 0);
user_pref("plugin.state.libvlcplugin", 0);
user_pref("pref.browser.language.disable_button.remove", false);
user_pref("pref.downloads.disable_button.edit_actions", false);
user_pref("privacy.clearOnShutdown.offlineApps", true);
user_pref("privacy.clearOnShutdown.siteSettings", true);
user_pref("privacy.donottrackheader.enabled", true);
user_pref("privacy.sanitize.didShutdownSanitize", true);
user_pref("privacy.sanitize.migrateClearSavedPwdsOnExit", true);
user_pref("privacy.sanitize.migrateFx3Prefs", true);
user_pref("privacy.sanitize.sanitizeOnShutdown", true);
user_pref("privacy.trackingprotection.enabled", true);
user_pref("reader.parse-on-load.enabled", false);
user_pref("security.OCSP.enabled", 0);
user_pref("security.ssl.require_safe_negotiation", true);
user_pref("security.ssl.treat_unsafe_negotiation_as_broken", true);
user_pref("security.tls.insecure_fallback_hosts.use_static_list", false);
user_pref("services.blocklist.addons.checked", 1484779325);
user_pref("services.blocklist.clock_skew_seconds", 50655);
user_pref("services.blocklist.gfx.checked", 1484779325);
user_pref("services.blocklist.last_update_seconds", 1484779325);
user_pref("services.blocklist.plugins.checked", 1484779325);
user_pref("services.sync.clients.lastSync", "0");
user_pref("services.sync.clients.lastSyncLocal", "0");
user_pref("services.sync.declinedEngines", "");
user_pref("services.sync.globalScore", 0);
user_pref("services.sync.migrated", true);
user_pref("services.sync.nextSync", 0);
user_pref("services.sync.tabs.lastSync", "0");
user_pref("services.sync.tabs.lastSyncLocal", "0");
user_pref("signon.autologin.proxy", true);
user_pref("signon.importedFromSqlite", true);
user_pref("signon.rememberSignons", false);
user_pref("storage.vacuum.last.index", 1);
user_pref("storage.vacuum.last.places.sqlite", 1483666629);
user_pref("toolkit.startup.last_success", 1484920754);
user_pref("toolkit.telemetry.cachedClientID", "62f61e98-a455-46b4-b90a-88b9e31f5af1");
user_pref("toolkit.telemetry.previousBuildID", "20161209150850");
user_pref("toolkit.telemetry.reportingpolicy.firstRun", false);
user_pref("toolkit.telemetry.unified", false);
user_pref("webgl.disabled", true);
EOF
mv ../all/* data/

echo "Adding standart configs..."
mv ../configs/* data/
rm -rf ../configs
echo '#!/bin/bash' > "${application}-portable"
echo 'dir=${0%/*}' >> "${application}-portable"
echo 'if [ "$dir" = "$0" ]; then' >> "${application}-portable"
echo ' dir="."' >> "${application}-portable"
echo 'fi' >> "${application}-portable"
echo 'cd "$dir/app"' >> "${application}-portable"
echo "RANGE=12" >> "${application}-portable"
echo 'number=$RANDOM' >> "${application}-portable"
echo 'let "number %= $RANGE"' >> "${application}-portable"
echo 'what=`< /dev/urandom tr -dc "+"+"-" | head -c1`' >> "${application}-portable"
echo 'TZ=GMT${what}${number} ./firefox --profile ../data' >> "${application}-portable"

chmod u+x "$application-portable"
echo ... finished
rm -rf ../all
cat << EOF > ../startwithi2pd.sh
./i2pd/i2pd
./$dir/$application-portable
EOF
cat << EOF > ../startwithOUTi2pd.sh
./$dir/$application-portable
EOF
chmod u+x ../startwith*
rm ../$0
